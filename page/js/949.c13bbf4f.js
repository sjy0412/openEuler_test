"use strict";(self["webpackChunkopeneuler_test"]=self["webpackChunkopeneuler_test"]||[]).push([[949],{4949:function(t,e,a){a.r(e),a.d(e,{default:function(){return w}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"menu-box"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("创建一级下拉框")]),e("el-row",{staticClass:"menu-col"},[e("el-col",{staticClass:"flex-left",attrs:{span:9}},[e("p",[t._v("根目录")]),e("el-tree",{attrs:{data:t.data,"node-key":"id","expand-on-click-node":!1,"current-node-key":t.handelCurrent,"highlight-current":!0,"default-expanded-keys":t.defaultExpandedKeys},scopedSlots:t._u([{key:"default",fn:function({node:a,data:s}){return[e("div",{staticClass:"custom-tree-node",on:{click:function(e){return t.getCurrent(s)}}},[s.isEdit?t._e():e("div",{staticClass:"flex-row"},[e("span",[t._v(t._s(s.name+"/"+s.id))]),e("span",{staticClass:"edit-icon"},[e("i",{staticClass:"el-icon-circle-plus-outline",on:{click:()=>t.append(s)}}),s.rootId?e("i",{staticClass:"el-icon-edit-outline",on:{click:function(e){return t.editRelation(s)}}}):t._e(),e("i",{staticClass:"el-icon-delete",on:{click:()=>t.remove(a,s)}})])]),s.isEdit?e("div",{staticClass:"flex-row"},[e("span",{staticClass:"flex-input"},[e("el-input",{model:{value:s.name,callback:function(e){t.$set(s,"name",e)},expression:"data.name"}})],1),e("span",{staticClass:"edit-icon input-icon"},[e("i",{staticClass:"el-icon-circle-check",on:{click:function(e){return t.addRelation(a,s)}}}),e("i",{staticClass:"el-icon-delete",on:{click:function(e){return t.remove(a,s)}}})])]):t._e()])]}}])})],1),e("el-col",{staticClass:"flex-right",attrs:{span:14}},[e("MenuDetail")],1)],1),e("el-dialog",{attrs:{title:"创建下拉框",visible:t.dialogVisible,width:"656"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("Dialog",{on:{handleClose:t.handleClose}})],1)],1)},i=[],o=function(){var t=this,e=t._self._c;return e("div",[e("el-form",{ref:"form",attrs:{model:t.form,"label-position":"left","label-width":"80px"}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"请输入"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{attrs:{type:"textarea",maxlength:"100",placeholder:"请输入","show-word-limit":""},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),e("el-form-item",{attrs:{label:"权限"}},[e("el-radio-group",{model:{value:t.form.authority,callback:function(e){t.$set(t.form,"authority",e)},expression:"form.authority"}},[e("el-radio",{attrs:{label:"普通用户",name:"authority"}}),e("el-radio",{attrs:{label:"超级管理员",name:"authority"}}),e("el-radio",{attrs:{label:"项目支撑人员",name:"authority"}}),e("el-radio",{attrs:{label:"实验室管理员",name:"authority"}})],1)],1),e("div",{staticClass:"form-btn"},[e("el-button",{attrs:{type:"primary"},on:{click:t.addAccount}},[t._v("确 定")]),e("el-button",{on:{click:t.handleCancel}},[t._v("取 消")])],1)],1)],1)},l=[],r=a(8042);const n={getList(){const t="/rest/v1/drop-down-box/item-list";return r.Z.get(t)},getItem(t){const e=`/rest/v1/drop-down-box/${t}/item`;return r.Z.get(e)},createItem(t){const e="/rest/v1/drop-down-box/item";return r.Z.post(e,t)},addRelation(t){const e="/rest/v1/drop-down-box/add-relation";return r.Z.post(e,t)},deleteItem(t){const e=`/rest/v1/drop-down-box/delete-item?id=${t}`;return r.Z.post(e)}};var d={name:"Dialog",props:["isEdit"],data(){return{form:{name:"",description:"",authority:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}],authority:[{required:!0,message:"请选择",trigger:"change"}]}}},methods:{handleCancel(){this.$refs["form"].resetFields(),this.form={name:"",description:"",authority:""},this.$emit("handleClose",!1)},addAccount(){let t={name:this.form.name,description:this.form.description,authority:this.form.authority};"普通用户"===t.authority?t.authority=0:"超级管理员"===t.authority?t.authority=1:"项目支撑人员"===t.authority?t.authority=2:"实验室管理员"===t.authority&&(t.authority=3),n.createItem(t).then((t=>{t.data.code===this.$statusCode.LOGIN_FAILED?noLogin():t.data.code===this.$statusCode.SUCCESS?(this.$message({message:"下拉框创建成功",type:"success"}),this.handleCancel()):this.$message({message:t.data.msg,type:"error"})}))}}},c=d,u=a(1001),m=(0,u.Z)(c,o,l,!1,null,"c645872a",null),h=m.exports,p=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"detail-head"},[e("p",[t._v("下拉框详情")]),e("div",[t.isEdit?t._e():e("el-button",{on:{click:t.handleEdit}},[t._v("编辑")]),t.isEdit?e("el-button",{on:{click:t.handleSave}},[t._v("保存")]):t._e(),t.isEdit?e("el-button",{on:{click:function(e){t.isEdit=!1}}},[t._v("取消")]):t._e()],1)]),t.isEdit?e("el-form",{ref:"form",attrs:{model:t.form,"label-position":"left","label-width":"80px"}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"请输入"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":""},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),e("el-form-item",{attrs:{label:"权限"}},[e("el-radio-group",{model:{value:t.form.authority,callback:function(e){t.$set(t.form,"authority",e)},expression:"form.authority"}},[e("el-radio",{attrs:{label:"普通用户",name:"authority"}}),e("el-radio",{attrs:{label:"超级管理员",name:"authority"}}),e("el-radio",{attrs:{label:"项目支撑人员",name:"authority"}}),e("el-radio",{attrs:{label:"实验室管理员",name:"authority"}})],1)],1)],1):t._e(),t.isEdit?t._e():e("el-row",{attrs:{model:t.form}},[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"flex-row"},[e("p",{staticClass:"label"},[t._v("ID")]),e("p",{staticClass:"detail-value"},[t._v(t._s(t.form.id))])])]),e("el-col",{attrs:{span:24}},[e("div",{staticClass:"flex-row"},[e("p",{staticClass:"label"},[t._v("名称")]),e("p",{staticClass:"detail-value"},[t._v(t._s(t.form.name))])])]),e("el-col",{attrs:{span:24}},[e("div",{staticClass:"flex-row"},[e("p",{staticClass:"label"},[t._v("描述")]),e("p",{staticClass:"detail-value"},[t._v(t._s(t.form.desc))])])]),e("el-col",{attrs:{span:24}},[e("div",{staticClass:"flex-row"},[e("p",{staticClass:"label"},[t._v("权限")]),e("p",{staticClass:"detail-value"},[t._v(t._s(t.form.authority))])])])],1)],1)},f=[],C=a(3822),g={name:"MenuDetail",data(){return{isEdit:!1}},computed:{...(0,C.rn)("menu",{form:"dorpDownDetail"})},methods:{handleEdit(){this.isEdit=!0},handleSave(){}}},v=g,b=(0,u.Z)(v,p,f,!1,null,"29e015c0",null),y=b.exports,_=a(9691),x={name:"MenuManagement",components:{Dialog:h,MenuDetail:y},data(){return{defaultExpandedKeys:[],dialogVisible:!1,data:[],text:"",handelCurrent:""}},created(){this.getList()},methods:{...(0,C.OI)("menu",["switchDetail"]),getCurrent(t){let e={};t.rootId?this.data.forEach((a=>{a.id===t.rootId&&(e={id:a.id,name:a.name,desc:a.description,authority:a.authority})})):e={id:t.id,name:t.name,desc:t.description,authority:t.authority},this.switchDetail(e)},getList(){n.getList().then((t=>{t.data.code===this.$statusCode.LOGIN_FAILED?(0,_.K)():t.data.code===this.$statusCode.SUCCESS&&(this.data=t.data.body,this.getCurrent(this.data[0]))}))},append(t){this.defaultExpandedKeys.push(t.id);const e={name:"",isEdit:!0,children:[]};t.children||this.$set(t,"children",[]),t.children.push(e),console.log(t)},remove(t,e){if(e.id)n.deleteItem(e.id).then((t=>{t.data.code===this.$statusCode.LOGIN_FAILED?(0,_.K)():t.data.code===this.$statusCode.SUCCESS?(this.$message({message:"词条删除成功",type:"success"}),this.getList()):this.$message({message:t.data.msg,type:"error"})}));else{const a=t.parent,s=a.data.children||a.data,i=s.findIndex((t=>t.name===e.name));s.splice(i,1)}},addRelation(t,e){let a={fatherId:t.parent.data.id,description:e.name};n.addRelation(a).then((t=>{t.data.code===this.$statusCode.LOGIN_FAILED?(0,_.K)():t.data.code===this.$statusCode.SUCCESS?(this.$message({message:"词条新增成功",type:"success"}),e.isEdit=!1,this.getList()):this.$message({message:t.data.msg,type:"error"})}))},editRelation(t){console.log(t),t.isEdit=!0},handleClose(t){this.dialogVisible=t,this.getList()}}},k=x,E=(0,u.Z)(k,s,i,!1,null,"2576d3c2",null),w=E.exports},9691:function(t,e,a){a.d(e,{K:function(){return o}});var s=a(8499),i=a(1120);function o(){s.MessageBox.confirm("当前登录超时，请重新登录!","会话过期",{confirmButtonText:"确定",showCancelButton:!1,closeOnClickModal:!1,closeOnPressEscape:!1,showClose:!1}).then((()=>{i.Z.push("/login")})).catch((()=>{}))}}}]);
//# sourceMappingURL=949.c13bbf4f.js.map